{"version":3,"sources":["../dist-esnext/Move.js"],"names":["Board","Game","GameColor","Player","Position","getBackMove","move","from","to","getMoveXandY","getXandY","canMove","game","positionsWhereCanIGo","getPositionsWhereCanIGo","board","isBlackTurn","positions","findIndex","position","x","y","getBoardAfterMove","lastMove","setPieceOnBoard","hasBlackPiece","removePieceOnBoard","jumpPosition","lastPosition","getPosition","lastMoveJump","getGameAfterMove","backMove","getCleanBoard","Error","black","getColorAfterMove","white","movements","push","ended","score","won","getGameBeforeLastMove","pop","isComputer","getPlayerTurn"],"mappings":";;;;;;;AAAA;;IAAYA,K;;AACZ;;IAAYC,I;;AACZ;;IAAYC,S;;AACZ;;IAAYC,M;;AACZ;;IAAYC,Q;;;;AACZ;;;AAGA,SAASC,WAAT,CAAqBC,IAArB,EAA2B;AACvB,WAAO;AACHC,cAAMD,KAAKE,EADR;AAEHA,YAAIF,KAAKC;AAFN,KAAP;AAIH;AACD;;;AAGA,SAASE,YAAT,CAAsBH,IAAtB,EAA4B;AACxB,WAAO;AACHC,cAAMH,SAASM,QAAT,CAAkBJ,KAAKC,IAAvB,CADH;AAEHC,YAAIJ,SAASM,QAAT,CAAkBJ,KAAKE,EAAvB;AAFD,KAAP;AAIH;AACD,SAASG,OAAT,CAAiBC,IAAjB,EAAuBN,IAAvB,EAA6B;AACzB,QAAMO,uBAAuBb,MAAMc,uBAAN,CAA8BF,KAAKG,KAAnC,EAA0CT,KAAKC,IAA/C,EAAqDN,KAAKe,WAAL,CAAiBJ,IAAjB,CAArD,EAA6EK,SAA1G;AACA,WAAOJ,qBAAqBK,SAArB,CAA+B;AAAA,eAAYC,SAASC,CAAT,KAAed,KAAKE,EAAL,CAAQY,CAAvB,IAC3CD,SAASE,CAAT,KAAef,KAAKE,EAAL,CAAQa,CADQ;AAAA,KAA/B,KAC6B,CADpC;AAEH;AACD,SAASC,iBAAT,CAA2BP,KAA3B,EAAkCT,IAAlC,EAAwC;AACpCA,SAAKE,EAAL,CAAQe,QAAR,GAAmB,IAAnB;AACAjB,SAAKC,IAAL,CAAUgB,QAAV,GAAqB,IAArB;AACAR,YAAQf,MAAMwB,eAAN,CAAsBT,KAAtB,EAA6BT,KAAKE,EAAlC,EAAsCJ,SAASqB,aAAT,CAAuBnB,KAAKC,IAA5B,CAAtC,CAAR;AACAQ,YAAQf,MAAM0B,kBAAN,CAAyBX,KAAzB,EAAgCT,KAAKC,IAArC,CAAR;AACA,QAAIoB,eAAerB,KAAKE,EAAL,CAAQoB,YAA3B;AACA,WAAOD,YAAP,EAAqB;AACjB3B,cAAM6B,WAAN,CAAkBd,KAAlB,EAAyBY,YAAzB,EAAuCG,YAAvC,GAAsD,IAAtD;AACAH,uBAAeA,aAAaC,YAA5B;AACH;AACD,WAAOb,KAAP;AACH;AACD;;;;;;;;;AASA,SAASgB,gBAAT,CAA0BnB,IAA1B,EAAgCN,IAAhC,EAAwD;AAAA,QAAlB0B,QAAkB,uEAAP,KAAO;;AACpDpB,SAAKG,KAAL,GAAaf,MAAMiC,aAAN,CAAoBrB,KAAKG,KAAzB,CAAb;AACA,QAAI,CAACiB,QAAD,IAAa,CAACrB,QAAQC,IAAR,EAAcN,IAAd,CAAlB,EACI,MAAM,IAAI4B,KAAJ,CAAU,6BAAV,CAAN;AACJtB,SAAKG,KAAL,GAAaO,kBAAkBV,KAAKG,KAAvB,EAA8BT,IAA9B,CAAb;AACAM,SAAKuB,KAAL,GAAajC,UAAUkC,iBAAV,CAA4BxB,KAAKuB,KAAjC,EAAwC7B,IAAxC,CAAb;AACAM,SAAKyB,KAAL,GAAanC,UAAUkC,iBAAV,CAA4BxB,KAAKyB,KAAjC,EAAwC/B,IAAxC,CAAb;AACA,QAAI,CAAC0B,QAAL,EAAe;AACXpB,aAAK0B,SAAL,CAAeC,IAAf,CAAoB9B,aAAaH,IAAb,CAApB;AACAM,aAAK4B,KAAL,GAAa5B,KAAKuB,KAAL,CAAWM,KAAX,CAAiBC,GAAjB,IAAwB9B,KAAKyB,KAAL,CAAWI,KAAX,CAAiBC,GAAtD;AACH;AACD,WAAO9B,IAAP;AACH;AACD,SAAS+B,qBAAT,CAA+B/B,IAA/B,EAAqC;AACjC,QAAIW,WAAWX,KAAK0B,SAAL,CAAeM,GAAf,EAAf;AACA,QAAIrB,QAAJ,EACIX,OAAOmB,iBAAiBnB,IAAjB,EAAuBP,YAAYkB,QAAZ,CAAvB,EAA8C,IAA9C,CAAP;AACJ,QAAIpB,OAAO0C,UAAP,CAAkB5C,KAAK6C,aAAL,CAAmBlC,IAAnB,CAAlB,CAAJ,EAAiD;AAC7CW,mBAAWX,KAAK0B,SAAL,CAAeM,GAAf,EAAX;AACA,YAAIrB,QAAJ,EAAc;AACVX,mBAAOmB,iBAAiBnB,IAAjB,EAAuBP,YAAYkB,QAAZ,CAAvB,EAA8C,IAA9C,CAAP;AACH;AACJ;AACD,WAAOX,IAAP;AACH;QACQD,O,GAAAA,O;QAASN,W,GAAAA,W;QAAa0B,gB,GAAAA,gB;QAAkBY,qB,GAAAA,qB;QAAuBlC,Y,GAAAA,Y;AACxE","file":"Move.js","sourcesContent":["import * as Board from './Board';\nimport * as Game from './Game';\nimport * as GameColor from './GameColor';\nimport * as Player from './Player';\nimport * as Position from './Position';\n/**\n * Returns reverse move: from = to, to = from\n */\nfunction getBackMove(move) {\n    return {\n        from: move.to,\n        to: move.from\n    };\n}\n/**\n * Takes a move and returns it with clean positions {from: {x,y}, to: {x,y}}.\n */\nfunction getMoveXandY(move) {\n    return {\n        from: Position.getXandY(move.from),\n        to: Position.getXandY(move.to)\n    };\n}\nfunction canMove(game, move) {\n    const positionsWhereCanIGo = Board.getPositionsWhereCanIGo(game.board, move.from, Game.isBlackTurn(game)).positions;\n    return positionsWhereCanIGo.findIndex(position => position.x === move.to.x\n        && position.y === move.to.y) >= 0;\n}\nfunction getBoardAfterMove(board, move) {\n    move.to.lastMove = true;\n    move.from.lastMove = true;\n    board = Board.setPieceOnBoard(board, move.to, Position.hasBlackPiece(move.from));\n    board = Board.removePieceOnBoard(board, move.from);\n    let jumpPosition = move.to.lastPosition;\n    while (jumpPosition) {\n        Board.getPosition(board, jumpPosition).lastMoveJump = true;\n        jumpPosition = jumpPosition.lastPosition;\n    }\n    return board;\n}\n/**\n * Takes game and move and returns new game after move.\n *\n * Updates:\n *  - .board (Cleans board, set positions and move breadcrumb)\n *  - .black (Calculate score)\n *  - .white (Calculate score)\n *  - .movements (add new move)\n */\nfunction getGameAfterMove(game, move, backMove = false) {\n    game.board = Board.getCleanBoard(game.board);\n    if (!backMove && !canMove(game, move))\n        throw new Error('ERROR_CANT_MOVE_TO_POSITION');\n    game.board = getBoardAfterMove(game.board, move);\n    game.black = GameColor.getColorAfterMove(game.black, move);\n    game.white = GameColor.getColorAfterMove(game.white, move);\n    if (!backMove) {\n        game.movements.push(getMoveXandY(move));\n        game.ended = game.black.score.won || game.white.score.won;\n    }\n    return game;\n}\nfunction getGameBeforeLastMove(game) {\n    let lastMove = game.movements.pop();\n    if (lastMove)\n        game = getGameAfterMove(game, getBackMove(lastMove), true);\n    if (Player.isComputer(Game.getPlayerTurn(game))) {\n        lastMove = game.movements.pop();\n        if (lastMove) {\n            game = getGameAfterMove(game, getBackMove(lastMove), true);\n        }\n    }\n    return game;\n}\nexport { canMove, getBackMove, getGameAfterMove, getGameBeforeLastMove, getMoveXandY };\n//# sourceMappingURL=Move.js.map"]}