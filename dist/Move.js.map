{"version":3,"sources":["../dist-esnext/Move.js"],"names":["Board","Game","Player","Position","Score","getBackMove","move","from","to","getMoveXAndY","getXAndY","canMove","game","isMyTurn","positionsWhereCanIGo","getPositionsWhereCanIGo","board","isBlackTurn","some","hasSameXY","position","canNotMove","compose","not","getJumps","jumps","lastPosition","concat","getBoardAfterMove","getPosition","mapBoard","x","p","y","isBlack","lastMove","containsXY","lastMoveJump","getGameAfterMove","backMove","Error","players","score","getScore","moves","getGameBeforeLastMove","pop","isComputer","getPlayerTurn","getMoveFromArray","getPositionFromArray","getMovesFromArray","map","getGameAfterMoves","reduce","lastGame"],"mappings":"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","file":"Move.js","sourcesContent":["import R from 'ramda';\nimport * as Board from './Board';\nimport * as Game from './Game';\nimport * as Player from './Player';\nimport * as Position from './Position';\nimport * as Score from './Score';\n/**\n * Returns reverse move: from = to, to = from\n */\nfunction getBackMove(move) {\n    return {\n        from: move.to,\n        to: move.from\n    };\n}\n/**\n * Takes a move and returns it with clean positions {from: {x,y}, to: {x,y}}.\n */\nfunction getMoveXAndY(move) {\n    return {\n        from: Position.getXAndY(move.from),\n        to: Position.getXAndY(move.to)\n    };\n}\n/**\n * Takes game and move then:\n *  - Checks if it is my turn to play otherwise returns false.\n *  - Get positions where can i go.\n *  - Returns true if move.to is in the positions where can i go.\n */\nfunction canMove(game, move) {\n    if (!Game.isMyTurn(game, move.from))\n        return false;\n    const positionsWhereCanIGo = Board.getPositionsWhereCanIGo(game.board, move.from, Game.isBlackTurn(game));\n    return positionsWhereCanIGo.some(position => Position.hasSameXY(position, move.to));\n}\n/**\n * Can not move\n */\nconst canNotMove = R.compose(R.not, canMove);\n/**\n * Get a position and recursively return all positions in .lastPosition\n */\nfunction getJumps(to, jumps) {\n    return to && to.lastPosition\n        ? getJumps(to.lastPosition).concat(to.lastPosition)\n        : jumps || [];\n}\n/**\n * Get board after move, return a new board with:\n *  - From: Remove piece and add .lastMove: true\n *  - To: Set piece from move.from and add .lastMove: true\n *  - Jumps: Create jump breadcrumb by setting .lastMoveJump: true\n */\nfunction getBoardAfterMove(board, move) {\n    const jumps = getJumps(move.to);\n    const from = Board.getPosition(board, move.from);\n    return Board.mapBoard(board, p => {\n        const { x, y, isBlack } = p;\n        if (Position.hasSameXY(from, p))\n            return { x, y, lastMove: true };\n        if (Position.hasSameXY(move.to, p))\n            return { x, y, isBlack: from.isBlack, lastMove: true };\n        if (Position.containsXY(jumps, p))\n            return { x, y, lastMoveJump: true };\n        return { x, y, isBlack };\n    });\n}\n/**\n * Takes game and move and returns new game after move.\n *\n * Updates:\n *  - .board (It cleans board, set new positions and move breadcrumb)\n *  - .score\n *  - .moves (add new move if valid)\n */\nfunction getGameAfterMove(game, move, backMove = false) {\n    if (!backMove && canNotMove(game, move))\n        throw new Error('ERROR_CANT_MOVE_TO_POSITION');\n    const board = getBoardAfterMove(game.board, move);\n    return {\n        players: game.players,\n        board,\n        score: Score.getScore(game.board),\n        moves: backMove ? game.moves : game.moves.concat(getMoveXAndY(move))\n    };\n}\nfunction getGameBeforeLastMove(game) {\n    let lastMove = game.moves.pop();\n    if (lastMove)\n        game = getGameAfterMove(game, getBackMove(lastMove), true);\n    if (Player.isComputer(Game.getPlayerTurn(game))) {\n        lastMove = game.moves.pop();\n        if (lastMove) {\n            game = getGameAfterMove(game, getBackMove(lastMove), true);\n        }\n    }\n    return game;\n}\n/**\n * Get IMove from an array like\n * [[fromX,fromY], [toX, toY]]\n *\n * const move = [[5, 7], [5, 6]];\n */\nfunction getMoveFromArray(move) {\n    return {\n        from: Position.getPositionFromArray(move[0]),\n        to: Position.getPositionFromArray(move[1])\n    };\n}\n/**\n * Get IMove[] from an array like\n * [[fromX,fromY], [toX, toY]]\n *\n * const moves = [\n *      [[5, 7], [5, 6]],\n *      [[2, 0], [2, 1]],\n *      [[7, 7], [5, 5]]\n * ];\n */\nconst getMovesFromArray = (moves) => moves.map(move => getMoveFromArray(move));\n/**\n * Get game after n moves.\n */\nfunction getGameAfterMoves(game, moves) {\n    return moves.reduce((lastGame, move) => {\n        return getGameAfterMove(lastGame, move);\n    }, game);\n}\nexport { canMove, getBackMove, getGameAfterMove, getGameAfterMoves, getGameBeforeLastMove, getMoveFromArray, getMovesFromArray, getMoveXAndY };\n//# sourceMappingURL=Move.js.map"]}