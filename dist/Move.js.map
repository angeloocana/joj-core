{"version":3,"sources":["../dist-esnext/Move.js"],"names":["Board","Game","Player","Position","Score","getBackMove","move","from","to","getMoveXAndY","getXAndY","canMove","game","isMyTurn","positionsWhereCanIGo","getPositionsWhereCanIGo","board","isBlackTurn","some","hasSameXY","position","canNotMove","compose","not","getBoardAfterMove","lastMove","setPieceOnBoard","hasBlackPiece","removePieceOnBoard","jumpPosition","lastPosition","getPosition","lastMoveJump","getGameAfterMove","backMove","Error","players","score","getScore","moves","concat","getGameBeforeLastMove","pop","isComputer","getPlayerTurn","getMoveFromArray","getPositionFromArray","getMovesFromArray","map","getGameAfterMoves","reduce","lastGame"],"mappings":"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","file":"Move.js","sourcesContent":["import R from 'ramda';\nimport * as Board from './Board';\nimport * as Game from './Game';\nimport * as Player from './Player';\nimport * as Position from './Position';\nimport * as Score from './Score';\n/**\n * Returns reverse move: from = to, to = from\n */\nfunction getBackMove(move) {\n    return {\n        from: move.to,\n        to: move.from\n    };\n}\n/**\n * Takes a move and returns it with clean positions {from: {x,y}, to: {x,y}}.\n */\nfunction getMoveXAndY(move) {\n    return {\n        from: Position.getXAndY(move.from),\n        to: Position.getXAndY(move.to)\n    };\n}\n/**\n * Takes game and move then:\n *  - Checks if it is my turn to play otherwise returns false.\n *  - Get positions where can i go.\n *  - Returns true if move.to is in the positions where can i go.\n */\nfunction canMove(game, move) {\n    if (!Game.isMyTurn(game, move.from))\n        return false;\n    const positionsWhereCanIGo = Board.getPositionsWhereCanIGo(game.board, move.from, Game.isBlackTurn(game));\n    return positionsWhereCanIGo.some(position => Position.hasSameXY(position, move.to));\n}\n/**\n * Can not move\n */\nconst canNotMove = R.compose(R.not, canMove);\nfunction getBoardAfterMove(board, move) {\n    move.to.lastMove = true;\n    move.from.lastMove = true;\n    board = Board.setPieceOnBoard(board, move.to, Position.hasBlackPiece(move.from));\n    board = Board.removePieceOnBoard(board, move.from);\n    let jumpPosition = move.to.lastPosition;\n    while (jumpPosition) {\n        Board.getPosition(board, jumpPosition).lastMoveJump = true;\n        jumpPosition = jumpPosition.lastPosition;\n    }\n    return board;\n}\n/**\n * Takes game and move and returns new game after move.\n *\n * Updates:\n *  - .board (It cleans board, set new positions and move breadcrumb)\n *  - .score\n *  - .moves (add new move if valid)\n */\nfunction getGameAfterMove(game, move, backMove = false) {\n    if (!backMove && canNotMove(game, move))\n        throw new Error('ERROR_CANT_MOVE_TO_POSITION');\n    const board = getBoardAfterMove(game.board, move);\n    return {\n        players: game.players,\n        board,\n        score: Score.getScore(game.board),\n        moves: backMove ? game.moves : game.moves.concat(getMoveXAndY(move))\n    };\n}\nfunction getGameBeforeLastMove(game) {\n    let lastMove = game.moves.pop();\n    if (lastMove)\n        game = getGameAfterMove(game, getBackMove(lastMove), true);\n    if (Player.isComputer(Game.getPlayerTurn(game))) {\n        lastMove = game.moves.pop();\n        if (lastMove) {\n            game = getGameAfterMove(game, getBackMove(lastMove), true);\n        }\n    }\n    return game;\n}\n/**\n * Get IMove from an array like\n * [[fromX,fromY], [toX, toY]]\n *\n * const move = [[5, 7], [5, 6]];\n */\nfunction getMoveFromArray(move) {\n    return {\n        from: Position.getPositionFromArray(move[0]),\n        to: Position.getPositionFromArray(move[1])\n    };\n}\n/**\n * Get IMove[] from an array like\n * [[fromX,fromY], [toX, toY]]\n *\n * const moves = [\n *      [[5, 7], [5, 6]],\n *      [[2, 0], [2, 1]],\n *      [[7, 7], [5, 5]]\n * ];\n */\nconst getMovesFromArray = (moves) => moves.map(move => getMoveFromArray(move));\n/**\n * Get game after n moves.\n */\nfunction getGameAfterMoves(game, moves) {\n    return moves.reduce((lastGame, move) => {\n        return getGameAfterMove(lastGame, move);\n    }, game);\n}\nexport { canMove, getBackMove, getGameAfterMove, getGameAfterMoves, getGameBeforeLastMove, getMoveFromArray, getMovesFromArray, getMoveXAndY };\n//# sourceMappingURL=Move.js.map"]}